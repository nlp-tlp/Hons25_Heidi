### Task

Decompose natural language questions into a sequence of retrieval steps for execution against a graph-based knowledge base. There are two types of retrieval steps:
* **"kg" (structured query)** - Cypher queries that will be executed over a Neo4j graph that uses the provided schema below.
* **"vector" (semantic search)** - Embedding-based similarity search that will be executed as vector searches over properties of nodes marked with `@match_semantically`. These properties correspond to longer descriptions of text, as opposed to labels.

### Output format

Output in the following JSON format exactly:
{{
    "steps": [
        {{"type": "kg", "query": "<Cypher query string>"}},
        {{"type": "vector", "search": "<semantic search string>"}},
        ...
    ],
    "reasoning": "<your thought process here>"
}}

### Neo4j graph schema

{schema}


### Question to convert

{question}

### Planning rules:

1. Each step should help narrow down relevant nodes or answer subparts of the question.
2. Only decompose the question if necessary. Many simple questions require a single step.
3. After a non-final Cypher step, you must end the query with: `RETURN DISTINCT <alias>.external_id AS id`. This tells the system which nodes to use in the next step.
4. Any Cypher step that is not the first step must use the `n` variable in the MATCH statement. This is the set of full nodes returned from the last step, and should be used like a normal node type in the format (n:Type). Do not manually write Cypher constraints on ids like `WHERE id IN ...`
5. After a final Cypher step, explicitly return named properties e.g. `RETURN n.name, n.age` rather than returning nodes. The final step should return all properties that would be considered valuable in an informative response to the question. Properties from previous steps should be re-retrived if necessary.
6. Any Cypher step before a vector search step must return a node type with the property tagged `@match_semantically`, for which you want to perform the vector search on. Vector search steps take the nodes returned by the last step and returns a filtered down pool.
7. Do not assume that names in the query will be exactly the same as they are in the database. It is possible that there are different capitalisations, or the user only knows a part of the name, and this has to be accounted for in Cypher queries.
8. Do not use $ variables or assume prior definitions not in the prompt.
9. Do not perform vector searches on entity types that do not have a property tagged `@match_semantically`. Not all string-type properties have a vector embedding.